stat_smooth(method = "loess", formula = y ~ x, size = 1)
songcol  %>% select(singer,rank,year) %>% unnest_tokens(word,singer) %>% filter(word%in%topsing) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(singer=word) %>%
ggplot(aes(x=year,y=n,color=singer,group=singer))+#geom_line() + # group=singer important
stat_smooth(method = "loess", formula = y ~ x, size = 1)
songcol  %>% select(singer,rank,year) %>% unnest_tokens(word,singer) %>% filter(word%in%topsing) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(singer=word) %>%
ggplot(aes(x=year,y=n,color=singer,group=singer))+#geom_line() + # group=singer important
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)
scol1 = songcol %>% select(singer,rank,year) %>% unnest_tokens(word,singer) %>% count(word) %>% top_n(7) %>% arrange(desc(n))
topsing = scol1$word # vector of top singers
songcol  %>% select(singer,rank,year) %>% unnest_tokens(word,singer) %>% filter(word%in%topsing) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(singer=word) %>%
ggplot(aes(x=year,y=n,color=singer,group=singer))+#geom_line() + # group=singer important
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)
scol1 = songcol %>% select(singer,rank,year) %>% unnest_tokens(word,singer) %>% count(word) %>% top_n(5) %>% arrange(desc(n))
topsing = scol1$word # vector of top singers
# topsinger analysis by year multiple time series
songcol  %>% select(singer,rank,year) %>% unnest_tokens(word,singer) %>% filter(word%in%topsing) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(singer=word) %>%
ggplot(aes(x=year,y=n,color=singer,group=singer))+#geom_line() + # group=singer important
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)
song_animate = songcol  %>% select(singer,rank,year) %>% unnest_tokens(word,singer) %>% filter(word%in%topsing) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(singer=word) %>%
ggplot(aes(x=year,y=n,frame=year,cumulative = TRUE,color=singer,group=singer))
library(gganimate)
song_animate = songcol  %>% select(singer,rank,year) %>% unnest_tokens(word,singer) %>% filter(word%in%topsing) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(singer=word) %>%
ggplot(aes(x=year,y=n,frame=year,cumulative = TRUE,color=singer,group=singer))+stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)
gganimate(song_animate)
song_animate = songcol  %>% select(singer,rank,year) %>% unnest_tokens(word,singer) %>% filter(word%in%topsing) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(singer=word) %>%
ggplot(aes(x=year,y=n,frame=year))+stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)
library(gganimate)
gganimate(song_animate)
song_animate = songcol  %>% select(singer,rank,year) %>% unnest_tokens(word,singer) %>% filter(word%in%topsing) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(singer=word) %>%
ggplot(aes(x=year,y=n,frame = year))+stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)
library(gganimate)
gganimate(song_animate)
song_animate = songcol  %>% select(singer,rank,year) %>% unnest_tokens(word,singer) %>% filter(word%in%topsing) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(singer=word)
songcol  %>% select(singer,rank,year) %>% unnest_tokens(word,singer) %>% filter(word%in%topsing) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(singer=word)
ong_animate = songcol  %>% select(singer,rank,year) %>% unnest_tokens(word,singer) %>% filter(word%in%topsing) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(singer=word) %>%
ggplot(aes(x=year,y=n,frame = year,cumulative=TRUE))+stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)
library(gganimate)
gganimate(song_animate)
song_animate = songcol  %>% select(singer,rank,year) %>% unnest_tokens(word,singer) %>% filter(word%in%topsing) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(singer=word) %>%
ggplot(aes(x=year,y=n,frame = year,cumulative=TRUE))+stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)
gganimate(song_animate)
View(song_animate)
song_animate = songcol  %>% select(singer,rank,year) %>% unnest_tokens(word,singer) %>% filter(word%in%topsing) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(singer=word) %>%
ggplot(aes(x=year,y=n,frame = year,cumulative=TRUE))+geom_line(size = 2.5, color = "#474747")
gganimate(song_animate)
song_animate = songcol  %>% select(singer,rank,year) %>% unnest_tokens(word,singer) %>% filter(word%in%topsing) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(singer=word) %>%
ggplot(aes(x=year,y=n,frame = year,cumulative=TRUE,color=singer,group=singer))+geom_line(size = 2.5, color = "#474747")
library(gganimate)
gganimate(song_animate)
song_animate = songcol  %>% select(singer,rank,year) %>% unnest_tokens(word,singer) %>% filter(word%in%topsing) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(singer=word) %>%
ggplot(aes(x=year,y=n,frame = year,cumulative=TRUE,color=singer,group=singer))+geom_line(size = 2.5)
library(gganimate)
gganimate(song_animate)
gganimate(song_animate,ani.width = 800, ani.height = 500)
gganimate(song_animate,ani.width = 800, ani.height = 500)
songcol %>% select(lyricist,rank,year) %>% unnest_tokens(word,lyricist) %>% count(word) %>% top_n(5) %>% arrange(desc(n))
library(tidyverse)
library(rvest)
library(tidytext)
songcol %>% select(lyricist,rank,year) %>% unnest_tokens(word,lyricist) %>% count(word) %>% top_n(5) %>% arrange(desc(n))
songcol %>% mutate(lyricist= str_replace_all(lyricist," ","")) %>% select(lyricist,rank,year) %>% unnest_tokens(word,lyricist) %>% count(word) %>% top_n(5) %>% arrange(desc(n))
scol2 = songcol %>% mutate(lyricist= str_replace_all(lyricist," ","")) %>% select(lyricist,rank,year) %>% unnest_tokens(word,lyricist) %>% count(word) %>% top_n(5) %>% arrange(desc(n))
toplyrics = scol2$word # vector of lyricist
songcol %>% mutate(lyricist= str_replace_all(lyricist," ","")) %>% select(lyricist,rank,year) %>% unnest_tokens(word,lyricist) %>% filter(word%in%toplyrics) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(lyricist=word) %>%
ggplot(aes(x=year,y=n,color=lyricist,group=lyricist))+#geom_line() + # group=singer important
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)
songcol %>% mutate(music_director= str_replace_all(music_director," ","")) %>% select(music_director,rank,year) %>% unnest_tokens(word,music_director) %>% count(word) %>% top_n(5) %>% arrange(desc(n))
library(tidyverse)
library(rvest)
library(tidytext)
songcol %>% mutate(music_director= str_replace_all(music_director," ","")) %>% select(music_director,rank,year) %>% unnest_tokens(word,music_director) %>% count(word) %>% top_n(5) %>% arrange(desc(n))
scol3 = songcol %>% mutate(music_director= str_replace_all(music_director," ","")) %>% select(music_director,rank,year) %>% unnest_tokens(word,music_director) %>% count(word) %>% top_n(5) %>% arrange(desc(n))
topmusicd = scol3$word # vector of lyricist
songcol %>% mutate(music_director= str_replace_all(music_director," ","")) %>% select(music_director,rank,year) %>% unnest_tokens(word,music_director)  %>% filter(word%in%topmusicd) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(music_director=word) %>%
ggplot(aes(x=year,y=n,color=music_director,group=music_director))+#geom_line() + # group=singer important
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)
View(g1987)
g1987 %>% slice(-1) %>% mutate(rank=1:length(X1),year=rep(1987,length(X1)))%>% select(-X1) %>% select(rank,X2,X6,X4,X5,X3,year) %>% View()
g1987 %>% slice(-1) %>% mutate(rank=1:length(X1),year=rep(1987,length(X1)))%>% select(-X1) %>% select(rank,X2,X6,X4,X5,X3,year) %>%
rename(song=X2,singer=X6,music_director=X4,lyricist=X5,movie=X3)
View(g1984)
g1984  %>% slice(-1) %>% mutate(rank=1:length(X1),year=rep(1984,length(X1)))%>% select(-X1) %>% select(rank,X2,X6,X4,X5,X3,year) %>%
rename(song=X2,singer=X6,music_director=X4,lyricist=X5,movie=X3)
g1984=g1984  %>% slice(-1) %>% mutate(rank=1:length(X1),year=rep(1984,length(X1)))%>% select(-X1) %>% select(rank,X2,X6,X4,X5,X3,year) %>%
rename(song=X2,singer=X6,music_director=X4,lyricist=X5,movie=X3)
g1985=g1985  %>% slice(-1) %>% mutate(rank=1:length(X1),year=rep(1985,length(X1)))%>% select(-X1) %>% select(rank,X2,X6,X4,X5,X3,year) %>%
rename(song=X2,singer=X6,music_director=X4,lyricist=X5,movie=X3)
View(g1987)
g1987=g1987 %>% slice(-1) %>% mutate(rank=1:length(X1),year=rep(1987,length(X1)))%>% select(-X1) %>% select(rank,X2,X6,X4,X5,X3,year) %>%
rename(song=X2,singer=X6,music_director=X4,lyricist=X5,movie=X3)
g1986=g1986  %>% slice(-1) %>% mutate(rank=1:length(X1),year=rep(1986,length(X1)))%>% select(-X1) %>% select(rank,X2,X6,X4,X5,X3,year) %>%
rename(song=X2,singer=X6,music_director=X4,lyricist=X5,movie=X3)
g1988=read_html("http://indpaedia.com/ind/index.php/Cibaca_Geet_Mala_1988:_annual_list") %>%
html_node('table.MsoNormalTable') %>% html_table() %>% slice(-1) %>% mutate(rank=1:length(X1),year=rep(1988,length(X1)))%>% select(-X1) %>% select(rank,X2,X6,X4,X5,X3,year) %>%
rename(song=X2,singer=X6,music_director=X4,lyricist=X5,movie=X3)
g1988=read_html("http://indpaedia.com/ind/index.php/Cibaca_Geet_Mala_1988:_annual_list") %>%
html_node('table.MsoNormalTable') %>% html_table()
View(g1988)
read_html("http://indpaedia.com/ind/index.php/Cibaca_Geet_Mala_1988:_annual_list") %>%
html_node('table.MsoTableGrid') %>% html_table()
g1988=read_html("http://indpaedia.com/ind/index.php/Cibaca_Geet_Mala_1988:_annual_list") %>%
html_node('table.MsoTableGrid') %>% html_table() %>% slice(-1) %>% mutate(rank=1:length(X1),year=rep(1988,length(X1)))%>% select(-X1) %>% select(rank,X2,X6,X4,X5,X3,year) %>%
rename(song=X2,singer=X6,music_director=X4,lyricist=X5,movie=X3)
g1989=read_html("http://indpaedia.com/ind/index.php/Cibaca_Geet_Mala_1989:_annual_list") %>%
html_node('table.MsoTableGrid') %>% html_table() %>% slice(-1) %>% mutate(rank=1:length(X1),year=rep(1989,length(X1)))%>% select(-X1) %>% select(rank,X2,X6,X4,X5,X3,year) %>%
rename(song=X2,singer=X6,music_director=X4,lyricist=X5,movie=X3)
g1989=read_html("http://indpaedia.com/ind/index.php/Cibaca_Sangeet_Mala_1989:_annual_list") %>%
html_node('table.MsoNormalTable') %>% html_table() %>% slice(-1) %>% mutate(rank=1:length(X1),year=rep(1989,length(X1)))%>% select(-X1) %>% select(rank,X2,X6,X4,X5,X3,year) %>%
rename(song=X2,singer=X6,music_director=X4,lyricist=X5,movie=X3)
g1989=read_html("http://indpaedia.com/ind/index.php/Cibaca_Sangeet_Mala_1989:_annual_list") %>%
html_node('table.MsoNormalTable') %>% html_table()
View(g1989)
g1989%>% slice(-1) %>% mutate(rank=1:length(X1),year=rep(1989,length(X1)))%>% select(-X1) %>% select(rank,X2,X6,X4,X5,X3,year) %>%
rename(song=X2,singer=X6,music_director=X4,lyricist=X5,movie=X3)
g1989= g1989 %>% slice(-1) %>% mutate(rank=1:length(X1),year=rep(1989,length(X1)))%>% select(-X1) %>% select(rank,X2,X6,X4,X5,X3,year) %>%
rename(song=X2,singer=X6,music_director=X4,lyricist=X5,movie=X3)
g1990=read_html("http://indpaedia.com/ind/index.php/Cibaca_Sangeet_Mala_1990:_annual_list") %>%
html_node('table.MsoNormalTable') %>% html_table() %>% slice(-1) %>% mutate(rank=1:length(X1),year=rep(1990,length(X1)))%>% select(-X1) %>% select(rank,X2,X6,X4,X5,X3,year) %>%
rename(song=X2,singer=X6,music_director=X4,lyricist=X5,movie=X3)
g1991=read_html("http://indpaedia.com/ind/index.php/Cibaca_Sangeet_Mala_1991:_annual_list") %>%
html_node('table.MsoTableGrid') %>% html_table() %>% slice(-1) %>% mutate(rank=1:length(X1),year=rep(1991,length(X1)))%>% select(-X1) %>% select(rank,X2,X6,X4,X5,X3,year) %>%
rename(song=X2,singer=X6,music_director=X4,lyricist=X5,movie=X3)
View(g1991)
g1992=read_html("http://indpaedia.com/ind/index.php/Cibaca_Geet_Mala_1992:_annual_list") %>%
html_node('table.MsoTableGrid') %>% html_table() %>% slice(-1) %>% mutate(rank=1:length(X1),year=rep(1992,length(X1)))%>% select(-X1) %>% select(rank,X2,X6,X4,X5,X3,year) %>%
rename(song=X2,singer=X6,music_director=X4,lyricist=X5,movie=X3)
View(g1992)
View(fgh)
songcol %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>% count(word) %>% top_n(5) %>% arrange(desc(n))
songcol %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>% count(word) %>% top_n(10) %>% arrange(desc(n))
scol4 = songcol %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>% count(word) %>% top_n(7) %>% arrange(desc(n))
topact = scol4$word
songcol %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors)  %>% filter(word%in%topact) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(actors=word) %>%
ggplot(aes(x=year,y=n,color=actors,group=actors))+#geom_line() + # group=singer important
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)
songcol %>% filter(actors>1960,actors<1970) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>% count(word)
songcol %>% filter(actors>1960,actors<1970)
View(songcol)
songcol %>% filter(year>1959,year<1970) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>% count(word)
songcol %>% filter(year>1959,year<1970) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>% count(word) %>% top_n(10)
songcol %>% filter(year>1959,year<1970) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>% count(word) %>% arrange(desc(n))
songcol %>% filter(year>1950,year<1961) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>% count(word) %>% arrange(desc(n))
songcol %>% filter(year>1970,year<1981) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>% count(word) %>% arrange(desc(n))
songcol %>% filter(year>1970,year<1981) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>% count(word) %>% filter(n>10) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(actors=word) %>%
ggplot(aes(x=year,y=n,color=actors,group=actors))+#geom_line() + # group=singer important
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)
songcol %>% filter(year>1970,year<1981) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(actors=word) %>%
ggplot(aes(x=year,y=n,color=actors,group=actors))+#geom_line() + # group=singer important
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)
songcol %>% filter(year>1970,year<1981) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(actors=word)
songcol %>% filter(year>1970,year<1981) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(actors=word) %>% filter(n>10) %>% # at least ten popular
ggplot(aes(x=year,y=n,color=actors,group=actors))+#geom_line() + # group=singer important
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)
songcol %>% filter(year>1970,year<1981) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(actors=word) %>% filter(n>10)
songcol %>% filter(year>1970,year<1981) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(actors=word) %>% filter(n>5)
songcol %>% filter(year>1970,year<1981) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year)
songcol %>% filter(year>1970,year<1981) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(actors=word) %>% filter(n>=5)
songcol %>% filter(year>1970,year<1981) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(actors=word) %>% filter(n>=5) %>% # at least ten popular
ggplot(aes(x=year,y=n,color=actors,group=actors))+#geom_line() + # group=singer important
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)
songcol %>% filter(year>1970,year<1981) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(actors=word) %>% filter(n>5)
songcol %>% filter(year>1970,year<1981) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors)
songcol %>% filter(year>1970,year<1981) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>% count(word)
songcol %>% filter(year>1970,year<1981) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>% count(word) %>% top_n(10)
seventies= songcol %>% filter(year>1970,year<1981) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>% count(word) %>% top_n(10)
seventy = seventies$word
songcol %>% filter(year>1970,year<1981) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>% filter(word%in%seventy) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(actors=word)  %>% # at least greater than five songs a year bad,
ggplot(aes(x=year,y=n,color=actors,group=actors))+#geom_line() + # group=singer important
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)
seventies= songcol %>% filter(year>1970,year<1981) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>% count(word) %>% top_n(6)
seventy = seventies$word
songcol %>% filter(year>1970,year<1981) %>% mutate(actors= str_replace_all(actors," ","")) %>% select(actors,rank,year) %>% unnest_tokens(word,actors) %>% filter(word%in%seventy) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(actors=word)  %>% # at least greater than five songs a year bad,
ggplot(aes(x=year,y=n,color=actors,group=actors))+#geom_line() + # group=singer important
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)
g1993=read_html("http://indpaedia.com/ind/index.php/Cibaca_Geet_Mala_1993:_annual_list") %>%
html_node('table.MsoTableGrid') %>% html_table() %>% slice(-1) %>% mutate(rank=1:length(X1),year=rep(1993,length(X1)))%>% select(-X1) %>% select(rank,X2,X6,X4,X5,X3,year) %>%
rename(song=X2,singer=X6,music_director=X4,lyricist=X5,movie=X3)
g1993=read_html("http://indpaedia.com/ind/index.php/Cibaca_Geet_Mala_1993:_annual_list") %>%
html_node('table.MsoNormalTable') %>% html_table() %>% slice(-1) %>% mutate(rank=1:length(X1),year=rep(1993,length(X1)))%>% select(-X1) %>% select(rank,X2,X6,X4,X5,X3,year) %>%
rename(song=X2,singer=X6,music_director=X4,lyricist=X5,movie=X3)
View(g1993)
eighties = list(g1984,g1985,g1986,g1987,g1988,g1989,g1990,g1991,g1992,g1993)
library(tidyverse)
library(rvest)
library(tidytext)
eighty =bind_rows(eighties)
View(eighty)
str_replace(ex,"/"," ")
ex = " john/tom"
str_replace(ex,"/"," ")
ex = " john/tom s.janaki"
pattern= "/|."
str_replace(ex,pattern," ")
pattern= "(/|.)"
str_replace(ex,pattern," ")
pattern= (/|.)
str_replace(ex,pattern," ")
pattern= "/."
str_replace(ex,pattern," ")
pattern= "/"
str_replace(ex,pattern," ")
pattern= "[/.]"
str_replace(ex,pattern," ")
pattern= "/W"
str_replace(ex,pattern," ")
pattern= "/w"
str_replace(ex,pattern," ")
pattern= "//w"
str_replace(ex,pattern," ")
pattern= "//W"
str_replace(ex,pattern," ")
pattern= "[/]"
str_replace(ex,pattern," ")
pattern= "[/.]"
str_replace(ex,pattern," ")
pattern= "[/][.]"
str_replace(ex,pattern," ")
pattern= "/.+"
str_replace(ex,pattern," ")
pattern= "/"
str_replace(ex,pattern," ")
str_replace(ex,pattern," ") %>% str_replace(".","")
str_replace(ex,pattern," ") %>% str_replace("\.","")
str_replace(ex,pattern," ") %>% str_replace("\\.","")
ex = " "john/tom s.janaki""
ex = ""john/tom s.janaki""
ex = '\'john/tom s.janaki\''
ex
str_replace(ex,pattern," ") %>%  # replace pattern /
str_replace("\\.","") # replace .
str_replace ("\\'","")
str_replace(ex,pattern," ") %>%  # replace pattern /
str_replace("\\.","") # replace .
str_replace ("\\'","")
str_replace(ex,pattern," ") %>%  # replace pattern /
str_replace("\\.","") # replace .
str_replace ("\'","")
str_replace(ex,pattern," ") %>%  # replace pattern /
str_replace("\\.","") %>%  # replace .
str_replace("\'","")
ex = '\'john-dayal/tom s.janaki\''
ex
pattern= "/"
str_replace(ex,pattern," ") %>%  # replace pattern /
str_replace("\\.","") %>%  # replace .
str_replace("\'","") %>% # replace '
str_replace("-","") "-" replace
str_replace(ex,pattern," ") %>%  # replace pattern /
str_replace("\\.","") %>%  # replace .
str_replace("\'","") %>% # replace '
str_replace("-","")
ex = '\'john-dayal/tom s.janaki etc. \''
ex
str_replace(ex,pattern," ") %>%  # replace pattern /
str_replace("\\.","") %>%  # replace .
str_replace("\'","") %>% # replace '
str_replace("-","") #"-" replace
str_replace(ex,pattern," ") %>%  # replace pattern /
str_replace("\\.","") %>%  # replace .
str_replace("\'","") %>% # replace '
str_replace("-","") %>% #"-" replace
str_replace("etc\\.","") # replace etc.
str_replace_all(ex,pattern," ") %>%  # replace pattern /
str_replace_all("\\.","") %>%  # replace .
str_replace_all("\'","") %>% # replace '
str_replace_all("-","") %>% #"-" replace
str_replace_all("etc\\.","") # replace etc.
str_replace_all(ex,pattern," ") %>%  # replace pattern /
str_replace_all("\\.","") %>%  # replace .
str_replace_all("\'","") %>% # replace '
str_replace_all("-","")
str_replace_all(ex,pattern," ") %>%  # replace pattern /
str_replace_all("\\.","") %>%  # replace .
str_replace_all("\'","") %>% # replace '
str_replace_all("-","") %>% #"-" replace
str_replace_all("etc","")
ex = '\'john-dayal/tom s.janaki etc. ? \''
ex
str_replace_all(ex,pattern," ") %>%  # replace pattern /
str_replace_all("\\.","") %>%  # replace .
str_replace_all("\'","") %>% # replace '
str_replace_all("-","") %>% #"-" replace
str_replace_all("etc","") %>%  # replace etc.
str_replace_all("\?","")
str_replace_all(ex,pattern," ") %>%  # replace pattern /
str_replace_all("\\.","") %>%  # replace .
str_replace_all("\'","") %>% # replace '
str_replace_all("-","") %>% #"-" replace
str_replace_all("etc","") %>%  # replace etc.
str_replace_all("\\?","")
putt="['-.()']"
str_replace_all(ex,putt,"")
putt="['-.()'/]"
str_replace_all(ex,putt,"")
putt="['-.()'/?]"
str_replace_all(ex,putt,"")
ex = '\'john-dayal/tom s.janaki etc. ? (movies) \''
ex
str_replace_all(ex,putt,"")
str_replace_all(ex,pattern," ") %>%  # replace pattern /
str_replace_all("\\.","") %>%  # replace .
str_replace_all("\'","") %>% # replace '
str_replace_all("-","") %>% #"-" replace
str_replace_all("etc","") %>%  # replace etc.
str_replace_all("\\?","") %>%  # ? replace
str_replace_all("*\\(.*?\\)*","")
str_replace_all(ex,pattern," ") %>%  # replace pattern /
str_replace_all("\\.","") %>%  # replace .
str_replace_all("\'","") %>% # replace '
str_replace_all("-","") %>% #"-" replace
str_replace_all("etc","") %>%  # replace etc.
str_replace_all("\\?","") %>%  # ? replace
str_replace_all("*\(.*?\)*","")
str_replace_all(ex,pattern," ") %>%  # replace pattern /
str_replace_all("\\.","") %>%  # replace .
str_replace_all("\'","") %>% # replace '
str_replace_all("-","") %>% #"-" replace
str_replace_all("etc","") %>%  # replace etc.
str_replace_all("\\?","") %>%  # ? replace
str_replace_all("*\\(.*?\\)*","")
str_replace_all(ex,pattern," ") %>%  # replace pattern /
str_replace_all("\\.","") %>%  # replace .
str_replace_all("\'","") %>% # replace '
str_replace_all("-","") %>% #"-" replace
str_replace_all("etc","") %>%  # replace etc.
str_replace_all("\\?","") %>%  # ? replace
str_replace_all(" *\\(.*?\\) *","")
View(songcol)
songcol$movie %>%  str_replace_all(" *\\(.*?\\) *","")
songcol$movie = songcol$movie %>%  str_replace_all(" *\\(.*?\\) *","") # replace contents within parenthesis year
eighty$singer %>% str_replace_all(putt,"")
putt="['-'/?]"
eighty$singer %>% str_replace_all(putt,"")
eighty$singer %>% str_replace_all(putt,"") %>% str_replace_all("\\.","")
eighty$singer %>% str_replace_all(putt,"") %>% str_replace_all("\\.","") %>%
str_replace_all("etc","")
eighty$singer %>% str_replace_all(putt,"") %>% str_replace_all("\\.","") %>%
str_replace_all("etc","") %>%
str_replace_all("\\n","")
eighty$singer %>% str_replace_all(putt,"") %>% str_replace_all("\\.","") %>%
str_replace_all("etc","") %>%
str_replace_all("\\\n","")
eighty$singer %>% str_replace_all(putt,"") %>% str_replace_all("\\.","") %>%
str_replace_all("etc","") %>%
str_replace_all("\\\n","") %>%  # replace /n
str_replace_all(" *\\(.*?\\) *","")
eighty$singer= eighty$singer %>% str_replace_all(putt,"") %>% str_replace_all("\\.","") %>%
str_replace_all("etc","") %>%
str_replace_all("\\\n","") %>%  # replace /n
str_replace_all(" *\\(.*?\\) *","") # replace contents in parenthesis
View(eighty)
eighty =bind_rows(eighties)
eighty$singer
eighty$singer %>% str_replace_all("\\W","")
eighty$singer %>% str_replace_all(putt,"") %>% str_replace_all("\\.","") %>%
str_replace_all("etc","") %>%
str_replace_all("\\\n","") %>%  # replace /n
str_replace_all(" *\\(.*?\\) *","") # replace contents in parenthesis
eighty$singer= eighty$singer %>% str_replace_all(putt,"") %>% str_replace_all("\\.","") %>%
str_replace_all("etc","") %>%
str_replace_all("\\\n","") %>%  # replace /n
str_replace_all(" *\\(.*?\\) *","") %>%  # replace contents in parenthesis
str_replace_all(" ","")
eighty =bind_rows(eighties)
eighty$singer %>% str_replace_all(putt,"") %>% str_replace_all("\\.","") %>%
str_replace_all("etc","") %>%
str_replace_all("\\\n","") %>%  # replace /n
str_replace_all(" *\\(.*?\\) *","") %>%  # replace contents in parenthesis
str_replace_all(" ","")
eighty$singer= eighty$singer %>% str_replace_all(putt,"") %>% str_replace_all("\\.","") %>%
str_replace_all("etc","") %>%
str_replace_all("\\\n","") %>%  # replace /n
str_replace_all(" *\\(.*?\\) *","") %>%  # replace contents in parenthesis
str_replace_all(" ","")
scol80 = eighty %>% select(singer,rank,year) %>% unnest_tokens(word,singer) %>% count(word) %>% top_n(5) %>% arrange(desc(n))
topsing80 = scol80$word # vector of top singers
eighty  %>% select(singer,rank,year) %>% unnest_tokens(word,singer) %>% filter(word%in%topsing80) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(singer=word) %>%
ggplot(aes(x=year,y=n,color=singer,group=singer))+#geom_line() + # group=singer important
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)
summary(eighty$singer)
summary(unique(eighty$singer))
summary(factor(eighty$singer))
eighty$lyricist %>%  str_replace_all(putt,"") %>% str_replace_all("\\.","") %>%
str_replace_all("etc","") %>%
str_replace_all("\\\n","") %>%  # replace /n
str_replace_all(" *\\(.*?\\) *","") %>%  # replace contents in parenthesis
str_replace_all(" ","")
eighty$lyricist= eighty$lyricist %>%  str_replace_all(putt,"") %>% str_replace_all("\\.","") %>%
str_replace_all("etc","") %>%
str_replace_all("\\\n","") %>%  # replace /n
str_replace_all(" *\\(.*?\\) *","") %>%  # replace contents in parenthesis
str_replace_all(" ","")
scol82 = eighty %>% mutate(lyricist= str_replace_all(lyricist," ","")) %>% select(lyricist,rank,year) %>% unnest_tokens(word,lyricist) %>% count(word) %>% top_n(5) %>% arrange(desc(n))
toplyrics1 = scol82$word # vector of lyricist
eighty %>% mutate(lyricist= str_replace_all(lyricist," ","")) %>% select(lyricist,rank,year) %>% unnest_tokens(word,lyricist) %>% filter(word%in%toplyrics1) %>%
group_by(year) %>% count(word) %>% arrange(desc(n)) %>% arrange(year) %>% rename(lyricist=word) %>%
ggplot(aes(x=year,y=n,color=lyricist,group=lyricist))+#geom_line() + # group=singer important
stat_smooth(method = "loess", formula = y ~ x, size = 1,se=FALSE)
eighty$movie  %>%  str_replace_all(putt,"") %>% str_replace_all("\\.","") %>%
str_replace_all("etc","") %>%
str_replace_all("\\\n","") %>%  # replace /n
str_replace_all(" *\\(.*?\\) *","") %>%  # replace contents in parenthesis
str_replace_all(" ","")
eighty$movie = eighty$movie  %>%  str_replace_all(putt,"") %>% str_replace_all("\\.","") %>%
str_replace_all("etc","") %>%
str_replace_all("\\\n","") %>%  # replace /n
str_replace_all(" *\\(.*?\\) *","") %>%  # replace contents in parenthesis
str_replace_all(" ","")
eighty$music_director  %>%  str_replace_all(putt,"") %>% str_replace_all("\\.","") %>%
str_replace_all("etc","") %>%
str_replace_all("\\\n","") %>%  # replace /n
str_replace_all(" *\\(.*?\\) *","") %>%  # replace contents in parenthesis
str_replace_all(" ","")
eighty$music_director  %>% str_replace_all("-","")
eighty$music_director  %>%   #str_replace_all("-","")
str_replace_all(putt,"") %>% str_replace_all("\\.","") %>%
str_replace_all("etc","") %>%
str_replace_all("\\\n","") %>%  # replace /n
str_replace_all(" *\\(.*?\\) *","") %>%  # replace contents in parenthesis
str_replace_all(" ","") %>% str_replace_all("-","")
eighty$music_director=eighty$music_director  %>%
str_replace_all(putt,"") %>% str_replace_all("\\.","") %>%
str_replace_all("etc","") %>%
str_replace_all("\\\n","") %>%  # replace /n
str_replace_all(" *\\(.*?\\) *","") %>%  # replace contents in parenthesis
str_replace_all(" ","") %>%
str_replace_all("-","") # to remove _
library(tidyverse)
library(rvest)
library(tidytext)
eighty %>% group_by(singer,music_director) %>% count(collaboration=n())
eighty %>% group_by(singer,music_director) %>% count(collaboration=n()) %>% arrange(desc(n))
eighty %>% select(year,singer,music_director) %>% unnesy_tokens(word,singer) %>% rename(singer=word) %>% group_by(singer,music_director) %>% count(collaboration=n()) %>% arrange(desc(n))
eighty %>% select(year,singer,music_director) %>% unnest_tokens(word,singer) %>% rename(singer=word) %>% group_by(singer,music_director) %>% count(collaboration=n()) %>% arrange(desc(n))
fgh %>% select(year,singer,music_director) %>% unnest_tokens(word,singer) %>% rename(singer=word) %>% group_by(singer,music_director) %>% count(collaboration=n()) %>% arrange(desc(n))
View(songcol)
songcol %>% select(year,singer,music_director) %>% unnest_tokens(word,singer) %>% rename(singer=word) %>% group_by(singer,music_director) %>% count(collaboration=n()) %>% arrange(desc(n))
songcol %>% select(year,singer,music_director) %>% unnest_tokens(word,singer) %>% rename(singer=word) %>% group_by(singer,music_director) %>% count(collaboration=n()) %>% arrange(desc(n)) %>% View()
songcol %>% select(year,singer,music_director) %>% unnest_tokens(word,singer) %>% rename(singer=word) %>% group_by(singer,music_director) %>% count(collaboration=n()) %>% arrange(desc(n)) %>% arrange(music_director) %>% View()
songcol %>% select(year,singer,actors) %>% unnest_tokens(word,singer) %>% rename(singer=word) %>%
unnest_tokens(word,actors) %>% rename(actor=word) %>%
group_by(singer,actor) %>% count(collaboration=n()) %>% arrange(desc(n))  %>% View()
songcol %>% mutate(actors= str_replace_all(actors," ","")) %>% select(year,singer,actors) %>% unnest_tokens(word,singer) %>% rename(singer=word) %>%
unnest_tokens(word,actors) %>% rename(actor=word) %>%
group_by(singer,actor) %>% count(collaboration=n()) %>% arrange(desc(n))  %>% View()
songcol %>% filter(lyricist=="gulzar")
songcol %>% filter(lyricist=="guljar")
?str_detect
str_detect(songcol$lyricist,"gul")
str_detect(songcol$lyricist,"hasrat")
str_subset(songcol$lyricist,"sahir")
patty = "sahir|Sahir"
str_subset(songcol$lyricist,patty)
patty = "g(G)ulj(z)ar"
str_subset(songcol$lyricist,patty)
patty = "guljar|Guljar"
str_subset(songcol$lyricist,patty)
patty = "guljar|Guljar|Gulzar"
str_subset(songcol$lyricist,patty)
patty = "[gG]ul[zg]ar"
str_subset(songcol$lyricist,patty)
songcol %>% filter(lyricist==str_detect(patty))
songcol %>% filter(lyricist==str_detect(lyricist,patty))
songcol %>% filter(str_detect(lyricist,patty))
songcol %>% filter(str_detect(lyricist,patty)) %>% # using regex on filter
select(song,lyricist,singer,rank,movie) %>% View()
songcol %>% filter(str_detect(lyricist,patty)) %>% # using regex on filter
select(song,lyricist,singer,rank,year,movie) %>% View()
songcol %>% filter(str_detect(lyricist,pattr)) %>% # using regex on filter
select(song,lyricist,singer,rank,year,movie) %>% View()
pattr= "[gG](.+)r"
songcol %>% filter(str_detect(lyricist,pattr)) %>% # using regex on filter
select(song,lyricist,singer,rank,year,movie) %>% View()
pattri= "\b[gG](.+)r\b"
songcol %>% filter(str_detect(lyricist,pattri))
pattri= "\\b[gG](.+)r\\b"
songcol %>% filter(str_detect(lyricist,pattri))
songcol %>% filter(str_detect(lyricist,pattri)) %>% # using regex on filter
select(song,lyricist,singer,rank,year,movie) %>% View()
songcol %>% filter(str_detect(lyricist,pattri)) %>% # using regex on filter
select(song,lyricist,music_director,singer,rank,year,movie) %>% View()
